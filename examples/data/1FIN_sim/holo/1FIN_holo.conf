# ApoA1

#
# select simulation options
#
set do_langevin 0    ;# Using Langevin thermostat?
set do_stochres 0    ;# Using stochastic rescaling thermostat?
set do_piston 0      ;# Using Langevin piston, along with a thermostat?

# output steps
# (for CUDA do not perform output more frequently than every 500 steps)
#
set outsteps 5000     ;# output interval

# always do PME
set do_pme 1         ;# Using PME?

# set temperature
set temp 298         ;# temperature in Kelvin

#
# input files
#
coordinates          1FIN_holo_wb.pdb
structure            1FIN_holo_wb.psf
paraTypeCharmm	     on
parameters           ../FF/par_all36_carb.prm
parameters           ../FF/par_all36_lipid.prm
parameters           ../FF/par_all36_na.prm
parameters           ../FF/toppar_all36_carb_glycopeptide.str
parameters           ../FF/toppar_water_ions_namd.str
parameters           ../FF/par_all36_cgenff.prm
parameters           ../FF/par_all36_prot.prm
#
# simulation parameters
#

# setting initial velocities to temperature
#
temperature          $temp

# system-dependent periodic cell definition
#
cellBasisVector1     112.717 0.0 0.0
cellBasisVector2     0.0 98.608 0.0
cellBasisVector3     0.0 0.0 89.374
cellOrigin           -35.886 209.276 120.571

# non-bonded force parameters
#
exclude              scaled1-4
1-4scaling           1.0
switching            on
switchdist           8
cutoff               9
pairlistdist         10

# apply aggressive multiple time stepping
#
timestep             2.0
nonbondedFreq        1
fullElectFrequency   2  

rigidbonds  all
useSettle  on

# temperature control options
#
if { $do_langevin } {
  # constant temperature
  langevin            on     ;# do langevin dynamics
  langevinDamping     5      ;# damping coefficient (gamma) of 5/ps
  langevinTemp        $temp
  langevinHydrogen    off    ;# don't couple langevin bath to hydrogens
} elseif { $do_stochres } {
  stochRescale        on
  stochRescalePeriod  0.5
  stochRescaleFreq    20
  stochRescaleTemp    $temp
}

# pressure control options
# also need thermostat
#
if { $do_piston } {
  # constant pressure (variable volume)
  langevinPiston        on
  langevinPistonTarget  1.01325 ;#  in bar -> 1 atm
  langevinPistonPeriod  100.
  langevinPistonDecay   50.
  langevinPistonTemp    $temp

  useGroupPressure      yes  ;# needed for rigidBonds
  useFlexibleCell       no
  useConstantArea       no
}

# PME grid sizes based on periodic cell sizes
#
if { $do_pme } {
  PME                  on
  PMEGridSpacing       1.0 
  wrapWater            on              ;# wrap water to central cell
  wrapAll              on              ;# wrap other molecules too
}

fixedAtoms             on
fixedAtomsCol          B

# output parameters
#
outputName           output_holo

outputTiming         $outsteps
outputEnergies       $outsteps
restartfreq          5000     ;# 500 steps = every 1ps
dcdfreq              5000
xstFreq              5000

#margin 4
CUDASOAintegrate off

minimize 5000
run      100000

